第七章：两节点集群--双机热备
################################

前面的学习中我们都使用了三个节点，现在做两节点集群学习，我们先删除一个节点。

.. image:: ../../../images/ha/014.png


前面我们讲到了，开启quorum策略后，集群存活的票据数不能小于quorum的值，当总票据数为奇数时，quorum=(总票据数+1)/2,当总票据数为偶数时，quorum值=(总票据数/2)+1。

那么，当我们的集群数为2，总票据数为2的时候呢？按照前面的算法，quorum的值就是2了，那么挂掉一台不就不能用了？

但实际上，两个节点的时候，挂掉一台，集群还是可以正常工作的，另一个节点还是可以正常提供服务，因为当节点数只有两个的时候，集群会自动标记一下two_node: 1，这个时候，就不按照前面那个quorum来玩了，挂掉一个也不影响集群，实现双击热备。


.. code-block:: bash

    [root@node2 ~]# grep -A3 quorum /etc/corosync/corosync.conf
    quorum {
    provider: corosync_votequorum
    two_node: 1
    }

这就是我们的双击热备