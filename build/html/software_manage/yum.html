

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. 准备篇： &mdash; Poppy 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="系统常用服务" href="../common_service/readme.html" />
    <link rel="prev" title="yum" href="yum_index.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Poppy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Poppy 介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_management/readme.html">用户管理</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="readme.html">软件管理</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="rpm.html">rpm</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="yum_index.html">yum</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1. 准备篇：</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#http">1.1. 安装http服务器</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">1.2. 系统约定</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">2. 安装篇：</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">2.1. 安装环境</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">2.2. 创建镜像文件存放目录</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yum">2.3. 确定以上三个yum源上游源的同步镜像地址</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">2.4. 创建以上三个yum源同步脚本，并且设定脚本自动执行</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">2.5. 添加脚本定时执行任务</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">3. 测试篇：</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rsync">3.1. 安装rsync同步软件</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">3.2. 执行同步脚本</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yumrepo">3.3. 根据不同版本创建三个yum源的repo配置文件</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">3.4. 测试yum源是否配置正确</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../common_service/readme.html">系统常用服务</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/readme.html">安全管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../database/readme.html">数据库</a></li>
<li class="toctree-l1"><a class="reference internal" href="../storage/readme.html">存储</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monitor/readme.html">监控</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripts/readme.html">脚本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../virtualization/readme.html">虚拟化</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ha&amp;lb/readme.html">高可用 &amp; 负载均衡</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web/readme.html">web</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Poppy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="readme.html">软件管理</a> &raquo;</li>
        
          <li><a href="yum_index.html">yum</a> &raquo;</li>
        
      <li>1. 准备篇：</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/software_manage/yum.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>搭建yum源服务器</p>
<div class="section" id="id1">
<h1>1. 准备篇：<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="http">
<h2>1.1. 安装http服务器<a class="headerlink" href="#http" title="Permalink to this headline">¶</a></h2>
<p>这里使用Nginx服务器提供http服务</p>
<p>关于Nginx服务器搭建，参考：CentOS安装配置LNMP服务器（Nginx+PHP+MySQL）</p>
<p><a class="reference external" href="http://www.osyunwei.com/archives/5910.html">http://www.osyunwei.com/archives/5910.html</a></p>
</div>
<div class="section" id="id2">
<h2>1.2. 系统约定<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Nginx站点根目录:/www/share</p>
<p>服务器执行脚本文件存放目录:/home/crontab</p>
<p>三、开始Nginx目录浏览功能</p>
<p>#编辑nginx配置文件，添加以下内容：</p>
<p>autoindex on; #开启nginx目录浏览功能</p>
<p>autoindex_exact_size off; #文件大小从KB开始显示</p>
<p>autoindex_localtime on; #显示文件修改时间为服务器本地时间</p>
<p>service nginx reload #重新加载配置</p>
</div>
</div>
<div class="section" id="id3">
<h1>2. 安装篇：<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id4">
<h2>2.1. 安装环境<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>系统版本： centos7.4
Hostname: dc.alv.pub</p>
</div>
<div class="section" id="id5">
<h2>2.2. 创建镜像文件存放目录<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>mkdir -p /www/share/centos #CentOS官方标准源</p>
<p>mkdir -p /www/share/repoforge #第三方rpmforge源</p>
<p>mkdir -p /www/share/epel #第三方epel源</p>
<p>说明：这里创建三个文件夹，分别存放CentOS官方标准源、第三方的rpmforge源和epel源</p>
</div>
<div class="section" id="yum">
<h2>2.3. 确定以上三个yum源上游源的同步镜像地址<a class="headerlink" href="#yum" title="Permalink to this headline">¶</a></h2>
<p>1、CentOS官方标准源：rsync://rsync.mirrors.ustc.edu.cn/centos/</p>
<p>2、rpmforge源：rsync://rsync.mirrors.ispros.com.bd/repoforge/</p>
<p>3、epel源：rsync://rsync.mirrors.ustc.edu.cn/epel/</p>
<p>备注：上游yum源必须要支持rsync协议，否则不能使用rsync进行同步。</p>
<p>参考：</p>
<p>CentOS官方标准源：</p>
<p>rsync://mirrors.kernel.org/centos</p>
<p>rpmforge源：</p>
<p><a class="reference external" href="http://apt.sw.be/">http://apt.sw.be/</a></p>
<p>rsync://ftp-stud.fht-esslingen.de/dag</p>
<p>epel源：</p>
<p><a class="reference external" href="http://mirrors.fedoraproject.org/publiclist/EPEL/">http://mirrors.fedoraproject.org/publiclist/EPEL/</a></p>
<p>rsync://mirrors.kernel.org/fedora-epel</p>
</div>
<div class="section" id="id6">
<h2>2.4. 创建以上三个yum源同步脚本，并且设定脚本自动执行<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>mkdir -p /home/crontab #创建目录</p>
<p>vi /home/crontab/yum_rsync.sh #添加以下代码</p>
<p>#!/bin/sh</p>
<p>/usr/bin/rsync -avrt rsync://rsync.mirrors.ustc.edu.cn/centos/ –exclude-from=/www/share/exclude_centos.list /www/share/centos/</p>
<p>/usr/bin/rsync -avrt rsync://ftp-stud.fht-esslingen.de/dag/ –exclude-from=/www/share/exclude_repoforge.list /www/share/repoforge/</p>
<p>/usr/bin/rsync -avrt rsync://rsync.mirrors.ustc.edu.cn/epel/ –exclude-from=/www/share/exclude_epel.list /www/share/epel/</p>
<p>:wq! #保存退出</p>
<p>chmod +x /home/crontab/yum_rsync.sh #添加脚本执行权限</p>
<p>查看目录列表</p>
<p>rsync –list-only  rsync://rsync.mirrors.ustc.edu.cn/centos/</p>
<p>备注：运行此脚本前，先要创建好同步目录及不需要同步的目录列表文件</p>
<p>cd /www/share/  #进入目录</p>
<p>touch exclude_centos.list   #创建文件</p>
<p>touch exclude_repoforge.list   #创建文件</p>
<p>touch exclude_epel.list   #创建文件</p>
<p>把不需要同步的目录写到上面对应的文件中，每行一个目录</p>
<p>例如：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s1">&#39;</span>
<span class="s1">4/</span>
<span class="s1">4AS/</span>
<span class="s1">4ES/</span>
<span class="s1">4WS/</span>
<span class="s1">&#39;</span>&gt;exclude_epel.list
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>echo<span class="s1">&#39;</span>
<span class="s1">/centos/7.5.1804/isos/</span>
<span class="s1">/centos/7/isos/</span>
<span class="s1">/centos/6/isos/</span>
<span class="s1">/centos/6.9/isos/</span>
<span class="s1">&#39;</span>&gt;exclude_centos.list
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h2>2.5. 添加脚本定时执行任务<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>vi /etc/crontab  #在最后一行添加以下代码</p>
<p>0 1 * * * root /home/crontab/yum_rsync.sh #设置每天凌晨1点整开始执行脚本</p>
<p>:wq! #保存退出</p>
<p>service crond restart #重启</p>
</div>
</div>
<div class="section" id="id8">
<h1>3. 测试篇：<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rsync">
<h2>3.1. 安装rsync同步软件<a class="headerlink" href="#rsync" title="Permalink to this headline">¶</a></h2>
<p>yum install rsync xinetd #安装</p>
<p>vi /etc/xinetd.d/rsync #编辑配置文件，设置开机启动rsync</p>
<p>disable = no #修改为</p>
<p>/etc/init.d/xinetd start #启动（CentOS中是以xinetd 来管理Rsync服务的）</p>
<p>:wq! #保存退出</p>
</div>
<div class="section" id="id9">
<h2>3.2. 执行同步脚本<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>sh /home/crontab/yum_rsync.sh</p>
<p>注意：等待脚本执行完毕，首次同步，耗费的时间比较长！</p>
</div>
<div class="section" id="yumrepo">
<h2>3.3. 根据不同版本创建三个yum源的repo配置文件<a class="headerlink" href="#yumrepo" title="Permalink to this headline">¶</a></h2>
<p>cd /etc/yum.repos.d/ #进入目录</p>
<p>mv /etc/yum.repos.d/CentOS-Base.repo CentOS-Base.repo-bak</p>
<p>1、CentOS官方标准源：</p>
<p>CentOS 5.x系列：</p>
<p>vi /etc/yum.repos.d/CentOS-Base.repo #添加以下代码</p>
<p># CentOS-Base.repo</p>
<p>#</p>
<p># The mirror system uses the connecting IP address of the client and the</p>
<p># update status of each mirror to pick mirrors that are updated to and</p>
<p># geographically close to the client. You should use this for CentOS updates</p>
<p># unless you are manually picking other mirrors.</p>
<p>#</p>
<p># If the mirrorlist= does not work for you, as a fall back you can try the</p>
<p># remarked out baseurl= line instead.</p>
<p>#</p>
<p>#</p>
<p>[base]</p>
<p>name=CentOS-$releasever - Base - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/os/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os</p>
<p>gpgcheck=1</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-5</p>
<p>#released updates</p>
<p>[updates]</p>
<p>name=CentOS-$releasever - Updates - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/updates/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates</p>
<p>gpgcheck=1</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-5</p>
<p>#packages used/produced in the build but not released</p>
<p>[addons]</p>
<p>name=CentOS-$releasever - Addons - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/addons/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=addons</p>
<p>gpgcheck=1</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-5</p>
<p>#additional packages that may be useful</p>
<p>[extras]</p>
<p>name=CentOS-$releasever - Extras - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/extras/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras</p>
<p>gpgcheck=1</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-5</p>
<p>#additional packages that extend functionality of existing packages</p>
<p>[centosplus]</p>
<p>name=CentOS-$releasever - Plus - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/centosplus/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus</p>
<p>gpgcheck=1</p>
<p>enabled=0</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-5</p>
<p>#contrib - packages by Centos Users</p>
<p>[contrib]</p>
<p>name=CentOS-$releasever - Contrib - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/contrib/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=contrib</p>
<p>gpgcheck=1</p>
<p>enabled=0</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-5</p>
<p>:wq! #保存退出</p>
<hr class="docutils" />
<p>CentOS 6.x系列：</p>
<p>vi /etc/yum.repos.d/CentOS-Base.repo #添加以下代码</p>
<p># CentOS-Base.repo</p>
<p>#</p>
<p># The mirror system uses the connecting IP address of the client and the</p>
<p># update status of each mirror to pick mirrors that are updated to and</p>
<p># geographically close to the client. You should use this for CentOS updates</p>
<p># unless you are manually picking other mirrors.</p>
<p>#</p>
<p># If the mirrorlist= does not work for you, as a fall back you can try the</p>
<p># remarked out baseurl= line instead.</p>
<p>#</p>
<p>#</p>
<p>[base]</p>
<p>name=CentOS-$releasever - Base - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/os/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os</p>
<p>gpgcheck=1</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-6</p>
<p>#released updates</p>
<p>[updates]</p>
<p>name=CentOS-$releasever - Updates - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/updates/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates</p>
<p>gpgcheck=1</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-6</p>
<p>#additional packages that may be useful</p>
<p>[extras]</p>
<p>name=CentOS-$releasever - Extras - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/extras/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras</p>
<p>gpgcheck=1</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-6</p>
<p>#additional packages that extend functionality of existing packages</p>
<p>[centosplus]</p>
<p>name=CentOS-$releasever - Plus - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/centosplus/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus</p>
<p>gpgcheck=1</p>
<p>enabled=0</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-6</p>
<p>#contrib - packages by Centos Users</p>
<p>[contrib]</p>
<p>name=CentOS-$releasever - Contrib - huanqiu.com</p>
<p>baseurl=http://dc.alv.pub/centos/$releasever/contrib/$basearch/</p>
<p>#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=contrib</p>
<p>gpgcheck=1</p>
<p>enabled=0</p>
<p>gpgkey=http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-6</p>
<p>:wq! #保存退出</p>
<hr class="docutils" />
<p>CentOS 7.x系列：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vi /etc/yum.repos.d/CentOS-Base.repo <span class="c1">#添加以下代码</span>
<span class="c1"># CentOS-Base.repo</span>
<span class="c1">#</span>
<span class="c1"># The mirror system uses the connecting IP address of the client and the</span>
<span class="c1"># update status of each mirror to pick mirrors that are updated to and</span>
<span class="c1"># geographically close to the client. You should use this for CentOS updates</span>
<span class="c1"># unless you are manually picking other mirrors.</span>
<span class="c1">#</span>
<span class="c1"># If the mirrorlist= does not work for you, as a fall back you can try the</span>
<span class="c1"># remarked out baseurl= line instead.</span>
<span class="c1">#</span>

<span class="o">[</span>base<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>CentOS-<span class="nv">$releasever</span> - Base
<span class="c1">#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=os</span>
<span class="nv">baseurl</span><span class="o">=</span>http://dc.alv.pub/centos/<span class="nv">$releasever</span>/os/<span class="nv">$basearch</span>/
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgkey</span><span class="o">=</span>http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-7

<span class="c1">#released updates</span>
<span class="o">[</span>updates<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>CentOS-<span class="nv">$releasever</span> - Updates
<span class="c1">#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=updates</span>
<span class="nv">baseurl</span><span class="o">=</span>http://dc.alv.pub/centos/<span class="nv">$releasever</span>/updates/<span class="nv">$basearch</span>/
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgkey</span><span class="o">=</span>http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-7

<span class="c1">#additional packages that may be useful</span>
<span class="o">[</span>extras<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>CentOS-<span class="nv">$releasever</span> - Extras
<span class="c1">#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=extras</span>
<span class="nv">baseurl</span><span class="o">=</span>http://dc.alv.pub/centos/<span class="nv">$releasever</span>/extras/<span class="nv">$basearch</span>/
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgkey</span><span class="o">=</span>http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-7

<span class="c1">#additional packages that extend functionality of existing packages</span>
<span class="o">[</span>centosplus<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>CentOS-<span class="nv">$releasever</span> - Plus
<span class="c1">#mirrorlist=http://mirrorlist.centos.org/?release=$releasever&amp;arch=$basearch&amp;repo=centosplus</span>
<span class="nv">baseurl</span><span class="o">=</span>http://dc.alv.pub/centos/<span class="nv">$releasever</span>/centosplus/<span class="nv">$basearch</span>/
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>
<span class="nv">enabled</span><span class="o">=</span><span class="m">0</span>
<span class="nv">gpgkey</span><span class="o">=</span>http://dc.alv.pub/centos/RPM-GPG-KEY-CentOS-7
</pre></div>
</div>
<hr class="docutils" />
<p>或者参考：<a class="reference external" href="https://lug.ustc.edu.cn/wiki/mirrors/help/centos">https://lug.ustc.edu.cn/wiki/mirrors/help/centos</a></p>
<p>把里面的http://mirrors.ustc.edu.cn/替换为http://dc.alv.pub/, 因为我们这台服务器的主机名和域名是dc.alv.pub</p>
<p>2、rpmforge源：</p>
<p>CentOS 5.x系列：</p>
<p>vi /etc/yum.repos.d/rpmforge.repo #添加以下代码</p>
<p>[rpmforge]</p>
<p>name = RHEL $releasever - RPMforge.net - dag</p>
<p>baseurl = <a class="reference external" href="http://dc.alv.pub/repoforge/redhat/el5/en/$basearch/rpmforge">http://dc.alv.pub/repoforge/redhat/el5/en/$basearch/rpmforge</a></p>
<p>enabled = 1</p>
<p>protect = 0</p>
<p>gpgkey=http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge</p>
<p>gpgcheck = 1</p>
<p>[rpmforge-extras]</p>
<p>name = RHEL $releasever - RPMforge.net - extras</p>
<p>baseurl = <a class="reference external" href="http://dc.alv.pub/repoforge/redhat/el5/en/$basearch/extras">http://dc.alv.pub/repoforge/redhat/el5/en/$basearch/extras</a></p>
<p>enabled = 0</p>
<p>protect = 0</p>
<p>gpgkey=http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge</p>
<p>gpgcheck = 1</p>
<p>[rpmforge-testing]</p>
<p>name = RHEL $releasever - RPMforge.net - testing</p>
<p>baseurl = <a class="reference external" href="http://dc.alv.pub/repoforge/redhat/el5/en/$basearch/testing">http://dc.alv.pub/repoforge/redhat/el5/en/$basearch/testing</a></p>
<p>enabled = 0</p>
<p>protect = 0</p>
<p>gpgkey=http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge</p>
<p>gpgcheck = 1</p>
<p>:wq! #保存退出</p>
<hr class="docutils" />
<p>系统运维  www.osyunwei.com  温馨提醒：qihang01原创内容©版权所有,转载请注明出处及原文链</p>
<p>CentOS 6.x系列：</p>
<p>vi /etc/yum.repos.d/rpmforge.repo #添加以下代码</p>
<p>[rpmforge]</p>
<p>name = RHEL $releasever - RPMforge.net - dag</p>
<p>baseurl = <a class="reference external" href="http://dc.alv.pub/repoforge/redhat/el6/en/$basearch/rpmforge">http://dc.alv.pub/repoforge/redhat/el6/en/$basearch/rpmforge</a></p>
<p>enabled = 1</p>
<p>protect = 0</p>
<p>gpgkey=http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge</p>
<p>gpgcheck = 1</p>
<p>[rpmforge-extras]</p>
<p>name = RHEL $releasever - RPMforge.net - extras</p>
<p>baseurl = <a class="reference external" href="http://dc.alv.pub/repoforge/redhat/el6/en/$basearch/extras">http://dc.alv.pub/repoforge/redhat/el6/en/$basearch/extras</a></p>
<p>enabled = 0</p>
<p>protect = 0</p>
<p>gpgkey=http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge</p>
<p>gpgcheck = 1</p>
<p>[rpmforge-testing]</p>
<p>name = RHEL $releasever - RPMforge.net - testing</p>
<p>baseurl = <a class="reference external" href="http://dc.alv.pub/repoforge/redhat/el6/en/$basearch/testing">http://dc.alv.pub/repoforge/redhat/el6/en/$basearch/testing</a></p>
<p>enabled = 0</p>
<p>protect = 0</p>
<p>gpgkey=http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge</p>
<p>gpgcheck = 1</p>
<p>:wq! #保存退出</p>
<hr class="docutils" />
<p>CentOS 7.x系列：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vi /etc/yum.repos.d/rpmforge.repo <span class="c1">#添加以下代码</span>

<span class="o">[</span>rpmforge<span class="o">]</span>
<span class="nv">name</span> <span class="o">=</span> RHEL <span class="nv">$releasever</span> - RPMforge.net - dag
<span class="nv">baseurl</span> <span class="o">=</span> http://dc.alv.pub/repoforge/redhat/el7/en/<span class="nv">$basearch</span>/rpmforge
<span class="nv">enabled</span> <span class="o">=</span> <span class="m">1</span>
<span class="nv">protect</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">gpgkey</span><span class="o">=</span>http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge
<span class="nv">gpgcheck</span> <span class="o">=</span> <span class="m">1</span>

<span class="o">[</span>rpmforge-extras<span class="o">]</span>
<span class="nv">name</span> <span class="o">=</span> RHEL <span class="nv">$releasever</span> - RPMforge.net - extras
<span class="nv">baseurl</span> <span class="o">=</span> http://dc.alv.pub/repoforge/redhat/el7/en/<span class="nv">$basearch</span>/extras
<span class="nv">enabled</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">protect</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">gpgkey</span><span class="o">=</span>http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge
<span class="nv">gpgcheck</span> <span class="o">=</span> <span class="m">1</span>

<span class="o">[</span>rpmforge-testing<span class="o">]</span>
<span class="nv">name</span> <span class="o">=</span> RHEL <span class="nv">$releasever</span> - RPMforge.net - testing
<span class="nv">baseurl</span> <span class="o">=</span> http://dc.alv.pub/repoforge/redhat/el7/en/<span class="nv">$basearch</span>/testing
<span class="nv">enabled</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">protect</span> <span class="o">=</span> <span class="m">0</span>
<span class="nv">gpgkey</span><span class="o">=</span>http://dc.alv.pub/repoforge/RPM-GPG-KEY-rpmforge
<span class="nv">gpgcheck</span> <span class="o">=</span> <span class="m">1</span>
</pre></div>
</div>
<hr class="docutils" />
<p>3、epel源：</p>
<p>CentOS 5.x系列：</p>
<p>vi /etc/yum.repos.d/epel.repo #添加以下代码</p>
<p>[epel]</p>
<p>name=Extra Packages for Enterprise Linux 5 - $basearch</p>
<p>baseurl=http://dc.alv.pub/epel/5/$basearch</p>
<p>failovermethod=priority</p>
<p>enabled=1</p>
<p>gpgcheck=1</p>
<p>gpgkey =http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-5</p>
<p>[epel-debuginfo]</p>
<p>name=Extra Packages for Enterprise Linux 5 - $basearch - Debug</p>
<p>baseurl=http://dc.alv.pub/epel/5/$basearch/debug</p>
<p>failovermethod=priority</p>
<p>enabled=0</p>
<p>gpgkey =http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-5</p>
<p>gpgcheck=1</p>
<p>[epel-source]</p>
<p>name=Extra Packages for Enterprise Linux 5 - $basearch - Source</p>
<p>baseurl=http://dc.alv.pub/epel/5/SRPMS</p>
<p>failovermethod=priority</p>
<p>enabled=0</p>
<p>gpgkey =http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-5</p>
<p>gpgcheck=1</p>
<p>:wq! #保存退出</p>
<hr class="docutils" />
<p>CentOS 6.x系列：</p>
<p>vi /etc/yum.repos.d/epel.repo #添加以下代码</p>
<p>[epel]</p>
<p>name=Extra Packages for Enterprise Linux 6 - $basearch</p>
<p>baseurl=http://dc.alv.pub/epel/6/$basearch</p>
<p>failovermethod=priority</p>
<p>enabled=1</p>
<p>gpgcheck=1</p>
<p>gpgkey =http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-6</p>
<p>[epel-debuginfo]</p>
<p>name=Extra Packages for Enterprise Linux 6 - $basearch - Debug</p>
<p>baseurl=http://dc.alv.pub/epel/6/$basearch/debug</p>
<p>failovermethod=priority</p>
<p>enabled=0</p>
<p>gpgkey =http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-6</p>
<p>gpgcheck=1</p>
<p>[epel-source]</p>
<p>name=Extra Packages for Enterprise Linux 6 - $basearch - Source</p>
<p>baseurl=http://dc.alv.pub/epel/6/SRPMS</p>
<p>failovermethod=priority</p>
<p>enabled=0</p>
<p>gpgkey =http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-6</p>
<p>gpgcheck=1</p>
<p>:wq! #保存退出</p>
<hr class="docutils" />
<p>CentOS 7.x系列：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vi /etc/yum.repos.d/epel.repo <span class="c1">#添加以下代码</span>
<span class="o">[</span>epel<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>Extra Packages <span class="k">for</span> Enterprise Linux <span class="m">7</span> - <span class="nv">$basearch</span>
<span class="nv">baseurl</span><span class="o">=</span>http://dc.alv.pub/epel/beta/7/<span class="nv">$basearch</span>
<span class="nv">failovermethod</span><span class="o">=</span>priority
<span class="nv">enabled</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>
<span class="nv">gpgkey</span> <span class="o">=</span>http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-7

<span class="o">[</span>epel-debuginfo<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>Extra Packages <span class="k">for</span> Enterprise Linux <span class="m">7</span> - <span class="nv">$basearch</span> - Debug
<span class="nv">baseurl</span><span class="o">=</span>http://dc.alv.pub/epel/beta/7/<span class="nv">$basearch</span>/debug
<span class="nv">failovermethod</span><span class="o">=</span>priority
<span class="nv">enabled</span><span class="o">=</span><span class="m">0</span>
<span class="nv">gpgkey</span> <span class="o">=</span>http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-7
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>

<span class="o">[</span>epel-source<span class="o">]</span>
<span class="nv">name</span><span class="o">=</span>Extra Packages <span class="k">for</span> Enterprise Linux <span class="m">7</span> - <span class="nv">$basearch</span> - Source
<span class="nv">baseurl</span><span class="o">=</span>http://dc.alv.pub/epel/beta/7/SRPMS
<span class="nv">failovermethod</span><span class="o">=</span>priority
<span class="nv">enabled</span><span class="o">=</span><span class="m">0</span>
<span class="nv">gpgkey</span> <span class="o">=</span>http://dc.alv.pub/epel/RPM-GPG-KEY-EPEL-7
<span class="nv">gpgcheck</span><span class="o">=</span><span class="m">1</span>
:wq! <span class="c1">#保存退出</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="id10">
<h2>3.4. 测试yum源是否配置正确<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>我们当前系统是centos7.4，所以按照上面描述的7的yum repo配置去编写repo文件，然后开始以下操作。</p>
<p>yum clean all #清除当前yum缓存</p>
<p>yum makecache #缓存yum源中的软件包信息</p>
<p>yum repolist #列出yum源中可用的软件包</p>
<p>2、使用yum命令安装软件</p>
<p>yum install php #测试CentOS官方标准源</p>
<p>yum install htop #测试rpmforge源</p>
<p>yum install nginx #测试epel源</p>
<p>至此，搭建CentOS在线yum源镜像服务器完成！</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../common_service/readme.html" class="btn btn-neutral float-right" title="系统常用服务" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="yum_index.html" class="btn btn-neutral" title="yum" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Alvin Wan.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>